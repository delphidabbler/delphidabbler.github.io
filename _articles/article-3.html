---
article: 3
title: "How to read data embedded in your program's resources"
summary: "Having embedded files and/or data in your executable (article #2) you need to get them out again - read on!"
meta-title: "Use Delphi Pascal to read data embedded in a program's resources | How to"
meta-desc: "An article that shows how to use Delphi Pascal to extract data files that were previously compiled into in a Windows program's resources."
demo-url: "https://github.com/delphidabbler/article-demos/tree/master/article-02+03"
link-prev: "/articles/article-2"
pages: 1
index: true
redirect_from:
- /articles/3
---
<h2>
    Why do it?
  </h2>

  <p>
    In a <?php
    echo $gLinker->InterLink(2, 0, '', 'previous article');
    ?> we dealt with why and how to embed data from a file in your program's
    resources. If we do that we're going to want to extract it again.
  </p>


  <h2>
    How it's done
  </h2>

  <p>
    This article assumes that the data you embedded was in the <var>RCDATA</var>
    format. This is a user-defined data format so we also assume that you know
    how to decode the format.
  </p>

  <p>
    Reading it back from the resource is very simple due to the
    <var>TResourceStream</var> class that ships with Delphi. You create a
    <var>TResourceStream</var> in one of two ways:
  </p>

  <div class="frame">
  <!-- Highlighted Pascal code generated by DelphiDabbler PasH -->
  <pre class="pas-source"><span class="pas-kwd">var</span>
    RS: TResourceStream;
  <span class="pas-kwd">begin</span>
    <span class="pas-comment">// Do this if the resource is named</span>
    RS := TResourceStream.Create(
      HInstance,     <span class="pas-comment">// your app or DLL instance handle</span>
      ResourceName,  <span class="pas-comment">// string containing resource name</span>
      RT_RCDATA);    <span class="pas-comment">// identifies RCDATA resource type</span>
    <span class="pas-comment">// ... or do this if it is identified by an ordinal </span>
    <span class="pas-comment">//     value (per my article on writing the data)</span>
    RS := TResourceStream.CreateFromID(
      HInstance,     <span class="pas-comment">// as above</span>
      ResourceID,    <span class="pas-comment">// Word identifier</span>
      RT_RCDATA);    <span class="pas-comment">// as above</span>
  <span class="pas-kwd">end</span>;</pre>
  <div class="footer">Listing 1</div>
  </div>

  <p>
    You now just use the stream to read the data as if it was coming from a
    file. You can't write to a <var>TResourceStream</var> as data embedded in an
    executable file is read only.
  </p>

  <p>
    To copy your embedded file into another stream (say <var>Stm</var> of type
    <var>TStream</var>) you can use this code:
  </p>

  <div class="frame">
  <!-- Highlighted Pascal code generated by DelphiDabbler PasH -->
  <pre class="pas-source">Stm.CopyFrom(RS, RS.Size);</pre>
  <div class="footer">Listing 2</div>
  </div>

  <p>
    As an example, say we have a program that includes a resource file that
    contains an <var>RCDATA</var> resource which has a copy of a rich text file
    inside it. The program displays the embedded rich text in a rich edit
    component. This is the code we need:
  </p>

  <div class="frame">
  <!-- Highlighted Pascal code generated by DelphiDabbler PasH -->
  <pre class="pas-source"><span class="pas-kwd">var</span>
    RS: TResourceStream;
  <span class="pas-kwd">begin</span>
    <span class="pas-comment">// Create resource stream (resource id is 100)</span>
    RS := TResourceStream.CreateFromID(HInstance,
      <span class="pas-num">100</span>, RT_RCDATA);
    <span class="pas-kwd">try</span>
      <span class="pas-comment">// Load the rich edit component</span>
      RichEdit1.Lines.LoadFromStream(RS);
    <span class="pas-kwd">finally</span>
      <span class="pas-comment">// Free the stream</span>
      RS.Free;
    <span class="pas-kwd">end</span>;
  <span class="pas-kwd">end</span>;</pre>
  <div class="footer">Listing 3</div>
  </div>


  <h2>
    Worked Example
  </h2>

  <p>
    You can download a <?php
    echo DocPart::DownloadTextLink('art-2-3', '', 'worked example');
    ?> that demonstrates what we've described here &ndash; it uses the above
    code. The zip file contains a pair of projects. The first is a program that
    embeds a supplied rich text file in a resource file. The second program
    includes the resource file and displays the rich text in a rich edit
    component as above.
  </p>

